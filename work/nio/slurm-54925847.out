SLURMD_NODENAME = hpc-33-16
Start time = Sun Nov 16 08:35:33 PM PST 2025
CUDA_VISIBLE_DEVICES = 0
OMP_NUM_THREADS = 32
MKL_NUM_THREADS = 4
OPENBLAS_NUM_THREADS = 4
PYSCF_MAX_MEMORY = 327680
TMPDIR = /resnick/scratch/yangjunjie//gpu4pyscf-occri/54925847/
PYSCF_TMPDIR = /resnick/scratch/yangjunjie//gpu4pyscf-occri/54925847/
Using GPU device 0
Free memory: 78.68 GB
Total memory: 79.19 GB
Discarded 8 diffused primitive functions, 0 contracted functions
#INFO: **** input file is /resnick/groups/changroup/members/junjiey/occri-main/work/nio/main.py ****
import cupy as cp

device = cp.cuda.Device()
print(f"Using GPU device {device.id}")

mem_info = cp.cuda.runtime.memGetInfo()
print(f"Free memory: {mem_info[0] / (1024**3):.2f} GB")
print(f"Total memory: {mem_info[1] / (1024**3):.2f} GB")

import pyscf, gpu4pyscf
from pyscf.pbc import gto
import gpu4pyscf.pbc
from gpu4pyscf.pbc.df import fft_jk

pcell = gto.Cell()
pcell.atom = """
Ni 0.0000 0.0000 0.0000
Ni 4.1700 4.1700 4.1700
O  2.0850 2.0850 2.0850
O  6.2550 6.2550 6.2550
"""
pcell.a = """
4.1700 2.0850 2.0850
2.0850 4.1700 2.0850
2.0850 2.0850 4.1700
"""
pcell.unit = "A"
pcell.basis = 'gth-dzvp-molopt-sr'
pcell.pseudo = "gth-hf-rev"
pcell.ke_cutoff = 200
pcell.exp_to_discard = 0.1
pcell.verbose = 5
pcell.build()

kpts = pcell.make_kpts([1, 1, 3])

from gpu4pyscf.pbc.scf import KRHF, KUHF
# mf = KRHF(pcell, kpts)
mf = KUHF(pcell, kpts)
mf.verbose = 5
mf.conv_tol = 1e-6
mf.max_cycle = 10
mf.exxdiv = None
dm0 = mf.get_init_guess(key='minao')

mf.kernel(dm0)
ene_ref = mf.e_tot

import numpy as np
from pyscf import lib
from pyscf.pbc.lib.kpts_helper import is_zero
from pyscf.pbc.df.df_jk import _format_kpts_band
from gpu4pyscf.lib.cupy_helper import contract
from gpu4pyscf.pbc import tools
from gpu4pyscf.pbc.df.df_jk import _format_dms, _format_jks

mf.with_df.ovlp_kpts = mf.get_ovlp()
def get_k_kpts_occri(mydf, dm_kpts, hermi=1, kpts=np.zeros((1,3)), 
                           kpts_band=None, exxdiv=None):
    cell = mydf.cell
    mesh = mydf.mesh
    assert cell.low_dim_ft_type != 'inf_vacuum'
    assert cell.dimension > 1
    coords = mydf.grids.coords
    ngrids = coords.shape[0]

    if getattr(dm_kpts, 'mo_coeff', None) is not None:
        mo_coeff = dm_kpts.mo_coeff
        mo_occ   = dm_kpts.mo_occ
    else:
        mo_coeff = None

    ni = mydf._numint
    kpts = np.asarray(kpts)
    dm_kpts = cp.asarray(dm_kpts, order='C')
    dms = _format_dms(dm_kpts, kpts)
    nset, nkpts, nao = dms.shape[:3]

    weight = (cell.vol / ngrids) / nkpts 

    kpts_band, input_band = _format_kpts_band(kpts_band, kpts), kpts_band
    nband = len(kpts_band)

    dtype = np.complex128
    if is_zero(kpts_band) and is_zero(kpts):
        dtype = dms.dtype
    vk_kpts = cp.zeros((nset, nband, nao, nao), dtype=dtype)

    if mo_coeff is not None and mo_occ is not None:
        mo_coeff = cp.asarray(mo_coeff).reshape(nset, nkpts, nao, -1)
        mo_occ = cp.asarray(mo_occ).reshape(nset, nkpts, -1)
    else:
        return _format_jks(vk_kpts, dm_kpts, input_band, kpts)

    blksize = 32

    from gpu4pyscf.pbc.dft.numint import eval_ao
    for s in range(nset):
        for k1 in range(nband):
            kpt1 = kpts_band[k1]
            ao1 = eval_ao(cell, coords, kpt=kpt1)

            mask = mo_occ[s, k1] > 0
            cocc1 = mo_coeff[s, k1][:, mask]
            
            mo1 = cp.dot(ao1, cocc1)
            mo1T = mo1.T.reshape(-1, 1, ngrids)
            nmo1 = mo1T.shape[0]

            vr_dm = cp.zeros((nmo1, ngrids), dtype=dtype)
            for k2 in range(nkpts):
                kpt2 = kpts[k2]
                ao2 = eval_ao(cell, coords, kpt=kpt2)

                k21 = kpt2 - kpt1
                coulg = tools.get_coulG(cell, k21, False, mydf, mesh)

                if not is_zero(k21):
                    k21 = cp.asarray(k21)
                    theta = cp.dot(coords, k21)
                    phase = cp.exp(-1j * theta)
                    ao2 = ao2 * phase.reshape(-1, 1)

                mask = mo_occ[s, k2] > 0
                mo2 = cp.dot(ao2, mo_coeff[s, k2][:, mask] * mo_occ[s, k2][mask] ** 0.5)
                mo2T = mo2.T.reshape(1, -1, ngrids)

                for i0, i1 in lib.prange(0, nmo1, blksize):
                    rhoR = mo1T[i0:i1].conj()* mo2T
                    rhoR = rhoR.reshape(-1, ngrids)

                    rhoG = tools.fft(rhoR, mesh)
                    vG = rhoG * coulg
                    rhoR = rhoG = None

                    vR = tools.ifft(vG, mesh).reshape(i1-i0, -1, ngrids)
                    vr_dm[i0:i1] += contract('ijg,gj->ig', vR, mo2.conj())
                    vR = vG = None

            ovlp1 = mydf.ovlp_kpts[k1]
            cinv1 = cp.dot(ovlp1, cocc1)
            ccinv = cp.dot(cocc1, cinv1.T.conj())
            
            # cinv_vr_dm = cp.dot(cinv1, vr_dm)
            # v1 = cp.dot(cinv_vr_dm, ao1) * weight
            v1 = cp.dot(vr_dm, ao1) * weight
            cinv_v1 = cp.dot(cinv1, v1)

            vk_kpts[s, k1] += cinv_v1 + cinv_v1.T.conj()
            vk_kpts[s, k1] -= cp.dot(cinv_v1, ccinv)

    if exxdiv == 'ewald':
        from gpu4pyscf.pbc.df.df_jk import _ewald_exxdiv_for_G0
        vk_kpts = _ewald_exxdiv_for_G0(cell, kpts, dms, vk_kpts, kpts_band=kpts_band)

    return _format_jks(vk_kpts, dm_kpts, input_band, kpts)

fft_jk.get_k_kpts = get_k_kpts_occri
mf.kernel(dm0)
ene_sol = mf.e_tot

print("ene_ref = %12.6f" % ene_ref)
print("ene_sol = %12.6f" % ene_sol)
print("error   = %6.2e" % abs(ene_ref - ene_sol))
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='hpc-33-16.cm.cluster', release='5.14.0-427.13.1.el9_4.x86_64', version='#1 SMP PREEMPT_DYNAMIC Wed Apr 10 10:29:16 EDT 2024', machine='x86_64')  Threads 32
Python 3.12.12 | packaged by Anaconda, Inc. | (main, Oct 21 2025, 20:16:04) [GCC 11.2.0]
numpy 2.2.6  scipy 1.16.3  h5py 3.15.1
Date: Sun Nov 16 20:35:41 2025
PySCF version 2.8.0
PySCF path  /home/junjiey/anaconda3/envs/gpu4pyscf-occri/lib/python3.12/site-packages/pyscf/__init__.py
CUDA Environment
    CuPy 13.4.1
    CUDA Path /home/junjiey/anaconda3/envs/gpu4pyscf-occri
    CUDA Build Version 12080
    CUDA Driver Version 12080
    CUDA Runtime Version 12080
CUDA toolkit
    cuSolver (11, 7, 2)
    cuBLAS 120804
    cuTENSOR 20200
Device info
    Device name b'NVIDIA H100 80GB HBM3'
    Device global memory 79.19 GB
    CuPy memory fraction 0.9
    Num. Devices 1
GPU4PySCF 1.4.3
GPU4PySCF path  /home/junjiey/anaconda3/envs/gpu4pyscf-occri/lib/python3.12/site-packages/gpu4pyscf

[ENV] PYSCF_TMPDIR /resnick/scratch/yangjunjie//gpu4pyscf-occri/54925847/
[ENV] PYSCF_MAX_MEMORY 327680
[CONFIG] conf_file None
[INPUT] verbose = 5
[INPUT] max_memory = 327680 
[INPUT] num. atoms = 4
[INPUT] num. electrons = 48
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = A
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Ni     0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr   0.0
[INPUT]  2 Ni     4.170000000000   4.170000000000   4.170000000000 AA    7.880157939436   7.880157939436   7.880157939436 Bohr   0.0
[INPUT]  3 O      2.085000000000   2.085000000000   2.085000000000 AA    3.940078969718   3.940078969718   3.940078969718 Bohr   0.0
[INPUT]  4 O      6.255000000000   6.255000000000   6.255000000000 AA   11.820236909154  11.820236909154  11.820236909154 Bohr   0.0
[INPUT] ---------------- BASIS SET ---------------- 
[INPUT] l, kappa, [nprim/nctr], expnt,             c_1 c_2 ...
[INPUT] O
[INPUT] 0    0    [5    /2   ]  10.3892280183     0.1262407229 0.0692157979
                                3.84962107201     0.1399337043 0.1156345389
                                1.38840118874     -0.4343482317 -0.3228397194
                                0.496955043655    -0.8527917909 -0.0959440166
                                0.16249161504     -0.2423515378 1.1028303487
[INPUT] 1    0    [5    /2   ]  10.3892280183     -0.0613020372 -0.0268627011
                                3.84962107201     -0.1900875117 -0.006283021
                                1.38840118874     -0.3777269828 -0.2248391878
                                0.496955043655    -0.454266086 0.3803246586
                                0.16249161504     -0.257388983 1.0541029199
[INPUT] 2    0    [5    /1   ]  10.3892280183     0.0298452275
                                3.84962107201     0.0609397339
                                1.38840118874     0.7323215801
                                0.496955043655    0.8935649184
                                0.16249161504     0.1529541887
[INPUT] Ni
[INPUT] 0    0    [5    /3   ]  10.0774277568     -0.169086929207 0.022677528942 0.008641083176
                                5.84773584833     -0.31374984113 0.057292097754 -0.136071800928
                                2.49403282601     0.766489587737 -0.198532965699 0.002540653375
                                0.988354848429    0.557414017577 -0.427662657827 -1.41846785564
                                0.344978242158    0.031729942841 0.260121348436 2.55022109317
[INPUT] 1    0    [5    /2   ]  10.0774277568     -0.126427871284 -0.005476801255
                                5.84773584833     0.241165311699 -0.010936526817
                                2.49403282601     0.543849904725 -0.096663192733
                                0.988354848429    0.407338672608 -0.097657540866
                                0.344978242158    0.053320914508 0.50842950018
[INPUT] 2    0    [5    /2   ]  10.0774277568     0.093966508982 -0.03309828405
                                5.84773584833     0.269388431386 -0.12702949251
                                2.49403282601     0.374569463127 -0.196169938991
                                0.988354848429    0.368089865298 -0.05399688986
                                0.344978242158    0.281719022542 0.14959062972
[INPUT] 3    0    [5    /1   ]  10.0774277568     -0.001956691144
                                5.84773584833     0.008799010286
                                2.49403282601     0.006398276758
                                0.988354848429    0.204329631644
                                0.344978242158    0.039178572608

Ewald components = 9.80510726917909, -254.944819814456, 5.81295484542821
nuclear repulsion = -239.326757699849
number of shells = 14
number of NR pGTOs = 250
number of NR cGTOs = 78
basis = gth-dzvp-molopt-sr
ecp = {}
CPU time:         2.06
lattice vectors  a1 [7.880157939, 3.940078970, 3.940078970]
                 a2 [3.940078970, 7.880157939, 3.940078970]
                 a3 [3.940078970, 3.940078970, 7.880157939]
dimension = 3
low_dim_ft_type = None
Cell volume = 244.667
exp_to_discard = 0.1
rcut = 18.873693607578385 (nimgs = [4 4 4])
lattice sum = 1053 cells
precision = 1e-08
pseudo = gth-hf-rev
ke_cutoff = 200
    = [63 63 63] mesh (250047 PWs)
Big error detected in the electron number of initial guess density matrix (Ne/cell = 23.9676)!
  This can cause huge error in Fock matrix and lead to instability in SCF for low-dimensional systems.
  DM is normalized wrt the number of electrons [24. 24.]


******** <class 'gpu4pyscf.pbc.scf.kuhf.KUHF'> ********
method = KUHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 10
direct_scf = True
direct_scf_tol = 1e-13
max_memory 327680 MB (current use 1366 MB)


******** PBC SCF flags ********
N kpts = 3
kpts = [[ 0.          0.          0.        ]
 [-0.13289043 -0.13289043  0.39867128]
 [-0.26578085 -0.26578085  0.79734256]]
Exchange divergence treatment (exxdiv) = None
DF object = <gpu4pyscf.pbc.df.fft.FFTDF object at 0x7efea0f54c20>
number of electrons per cell  alpha = 72 beta = 72
cond(S) = [563.61197933 572.14238317 572.14238317]
Set gradient conv threshold to 0.001
    CPU time for vj and vk                                               5.87 sec, wall time      8.25 sec, GPU time   8140.07 ms
E1 = (-229.7954650706186-4.799731054568811e-16j)  E_coul = (109.89149463953481+4.419018378514984e-16j)
init E= -359.230728130933
    CPU time for SCF initialization                                     14.41 sec, wall time     10.89 sec, GPU time  10894.60 ms
alpha HOMO = 1.01014777521  LUMO = 1.0101477821
beta HOMO = 1.01014777521  LUMO = 1.0101477821
    CPU time for vj and vk                                               3.33 sec, wall time      5.99 sec, GPU time   5990.17 ms
E1 = (-167.12723514868554-4.599908417131833e-16j)  E_coul = (52.822137932113584+3.8973454093612264e-16j)
    CPU time for cycle=1                                                 4.44 sec, wall time      7.33 sec, GPU time   7328.43 ms
cycle= 1 E= -353.631854916421  delta_E=  5.6  |g|= 9.36  |ddm|= 6.89
alpha HOMO = 0.770138985309  LUMO = 0.770459975544
beta HOMO = 0.770138985309  LUMO = 0.770459975544
    CPU time for vj and vk                                               3.34 sec, wall time      6.00 sec, GPU time   6000.98 ms
E1 = (-258.1297672426324-4.3368086899420177e-16j)  E_coul = (151.09866170572516+4.961309141293668e-16j)
    CPU time for cycle=2                                                 3.94 sec, wall time      6.69 sec, GPU time   6691.60 ms
cycle= 2 E= -346.357863236756  delta_E= 7.27  |g|=   11  |ddm|= 10.6
alpha HOMO = 0.687760559497  LUMO = 0.709105630584
beta HOMO = 0.687760559497  LUMO = 0.709105630584
    CPU time for vj and vk                                               3.33 sec, wall time      6.27 sec, GPU time   6272.65 ms
E1 = (-200.75985650593032-4.4004152173945005e-16j)  E_coul = (79.85612795396295+4.1470733097570545e-16j)
    CPU time for cycle=3                                                 3.37 sec, wall time      6.29 sec, GPU time   6291.13 ms
cycle= 3 E= -360.230486251816  delta_E= -13.9  |g|= 2.27  |ddm|= 7.44
alpha HOMO = 0.640948167914  LUMO = 0.803040966693
beta HOMO = 0.640948167914  LUMO = 0.803040966693
    CPU time for vj and vk                                               3.34 sec, wall time      6.46 sec, GPU time   6459.33 ms
E1 = (-205.3500413206478-4.414871246360974e-16j)  E_coul = (83.7821519816838+4.563949045077731e-16j)
    CPU time for cycle=4                                                 3.41 sec, wall time      6.48 sec, GPU time   6477.75 ms
cycle= 4 E= -360.894647038813  delta_E= -0.664  |g|= 0.656  |ddm|= 2.94
alpha HOMO = 0.540662857198  LUMO = 0.812073073176
beta HOMO = 0.540662857198  LUMO = 0.812073073176
    CPU time for vj and vk                                               3.35 sec, wall time      6.46 sec, GPU time   6460.59 ms
E1 = (-206.6986417387666-4.274647765386182e-16j)  E_coul = (85.10072466231294+4.183800658350001e-16j)
    CPU time for cycle=5                                                 3.42 sec, wall time      6.48 sec, GPU time   6479.07 ms
cycle= 5 E= -360.924674776303  delta_E= -0.03  |g|= 0.376  |ddm|= 0.651
alpha HOMO = 0.549666564529  LUMO = 0.830511603526
beta HOMO = 0.549666564529  LUMO = 0.830511603526
    CPU time for vj and vk                                               3.33 sec, wall time      6.38 sec, GPU time   6382.45 ms
E1 = (-207.4021983566387-4.2847669856627135e-16j)  E_coul = (85.78926067708184+4.517102476208252e-16j)
    CPU time for cycle=6                                                 3.41 sec, wall time      6.40 sec, GPU time   6401.04 ms
cycle= 6 E= -360.939695379406  delta_E= -0.015  |g|= 0.05  |ddm|= 0.293
alpha HOMO = 0.54667983489  LUMO = 0.830446556312
beta HOMO = 0.54667983489  LUMO = 0.830446556312
    CPU time for vj and vk                                               3.34 sec, wall time      6.38 sec, GPU time   6381.03 ms
E1 = (-207.582462560083-4.299042314267106e-16j)  E_coul = (85.96902560442106+4.3887826315855416e-16j)
    CPU time for cycle=7                                                 3.41 sec, wall time      6.40 sec, GPU time   6399.83 ms
cycle= 7 E= -360.940194655511  delta_E= -0.000499  |g|= 0.0166  |ddm|= 0.0558
alpha HOMO = 0.547216771161  LUMO = 0.828481091615
beta HOMO = 0.547216771161  LUMO = 0.828481091615
    CPU time for vj and vk                                               3.35 sec, wall time      6.38 sec, GPU time   6382.45 ms
E1 = (-207.60014038949134-4.370238256926987e-16j)  E_coul = (85.98643420259876+4.463118243036579e-16j)
    CPU time for cycle=8                                                 3.42 sec, wall time      6.40 sec, GPU time   6401.31 ms
cycle= 8 E= -360.940463886742  delta_E= -0.000269  |g|= 0.0143  |ddm|= 0.045
alpha HOMO = 0.547122445121  LUMO = 0.828392560003
beta HOMO = 0.547122445121  LUMO = 0.828392560003
    CPU time for vj and vk                                               3.33 sec, wall time      6.53 sec, GPU time   6530.45 ms
E1 = (-207.6127778514764-4.337079740485139e-16j)  E_coul = (85.99855495879423+4.1632459921632964e-16j)
    CPU time for cycle=9                                                 3.41 sec, wall time      6.55 sec, GPU time   6549.41 ms
cycle= 9 E= -360.940980592531  delta_E= -0.000517  |g|= 0.0105  |ddm|= 0.106
alpha HOMO = 0.546711000141  LUMO = 0.828855025556
beta HOMO = 0.546711000141  LUMO = 0.828855025556
    CPU time for vj and vk                                               3.32 sec, wall time      6.53 sec, GPU time   6528.12 ms
E1 = (-207.62182684189716-4.344127054606295e-16j)  E_coul = (86.00708067015532+4.4319474305776208e-16j)
    CPU time for cycle=10                                                3.39 sec, wall time      6.55 sec, GPU time   6547.07 ms
cycle= 10 E= -360.941503871591  delta_E= -0.000523  |g|= 0.00427  |ddm|= 0.216

WARN: SCF failed to converge

    CPU time for SCF                                                    50.51 sec, wall time     77.17 sec, GPU time  77171.27 ms
SCF not converged.
SCF energy = -360.941503871591


******** <class 'gpu4pyscf.pbc.scf.kuhf.KUHF'> ********
method = KUHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'gpu4pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-06
SCF conv_tol_grad = None
SCF max_cycles = 10
direct_scf = True
direct_scf_tol = 1e-13
max_memory 327680 MB (current use 1695 MB)


******** PBC SCF flags ********
N kpts = 3
kpts = [[ 0.          0.          0.        ]
 [-0.13289043 -0.13289043  0.39867128]
 [-0.26578085 -0.26578085  0.79734256]]
Exchange divergence treatment (exxdiv) = None
DF object = <gpu4pyscf.pbc.df.fft.FFTDF object at 0x7efea0f54c20>
number of electrons per cell  alpha = 72 beta = 72
cond(S) = [563.61197933 572.14238317 572.14238317]
Set gradient conv threshold to 0.001
    CPU time for vj and vk                                               0.44 sec, wall time      0.15 sec, GPU time     47.85 ms
E1 = (-229.7954650706186-4.799731054568811e-16j)  E_coul = (145.1839195667338-2.4988045968596965e-17j)
init E= -323.938303203734
    CPU time for SCF initialization                                      7.82 sec, wall time      0.79 sec, GPU time    790.05 ms
alpha HOMO = 1.78771563464  LUMO = 1.81321343426
beta HOMO = 1.78771563464  LUMO = 1.81321343426
    CPU time for vj and vk                                               1.93 sec, wall time      1.66 sec, GPU time   1656.89 ms
E1 = (-91.42058039245917-4.235616487176704e-16j)  E_coul = (13.193532740447075-5.146346312064527e-16j)
    CPU time for cycle=1                                                 1.96 sec, wall time      1.67 sec, GPU time   1672.61 ms
cycle= 1 E= -317.553805351861  delta_E= 6.38  |g|=   21  |ddm|= 13.1
alpha HOMO = 0.836971948592  LUMO = 0.836971949385
beta HOMO = 0.836971948592  LUMO = 0.836971949385
    CPU time for vj and vk                                               1.48 sec, wall time      1.11 sec, GPU time   1106.68 ms
E1 = (-271.27686155024185-3.469446951953614e-16j)  E_coul = (183.40116394396867+9.113080660464825e-16j)
    CPU time for cycle=2                                                 1.57 sec, wall time      1.13 sec, GPU time   1129.30 ms
cycle= 2 E= -327.202455306122  delta_E= -9.65  |g|=   14  |ddm|= 16.7
alpha HOMO = 1.114668084  LUMO = 1.11473284942
beta HOMO = 1.114668084  LUMO = 1.11473284942
    CPU time for vj and vk                                               1.45 sec, wall time      1.07 sec, GPU time   1071.62 ms
E1 = (-161.47012592742553-3.255497723249808e-16j)  E_coul = (51.967519387853976-7.161516749990918e-16j)
    CPU time for cycle=3                                                 1.52 sec, wall time      1.09 sec, GPU time   1089.49 ms
cycle= 3 E= -348.829364239421  delta_E= -21.6  |g|= 9.59  |ddm|= 13.3
alpha HOMO = 0.985367679102  LUMO = 1.13776341565
beta HOMO = 0.985367679102  LUMO = 1.13776341565
    CPU time for vj and vk                                               1.45 sec, wall time      1.05 sec, GPU time   1045.20 ms
E1 = (-188.10082282622935-3.5214886562329184e-16j)  E_coul = (69.47776824684354+2.2320108724234916e-16j)
    CPU time for cycle=4                                                 1.52 sec, wall time      1.06 sec, GPU time   1063.28 ms
cycle= 4 E= -357.949812279235  delta_E= -9.12  |g|= 3.69  |ddm|= 6.23
alpha HOMO = 0.809666438  LUMO = 1.34133868147
beta HOMO = 0.809666438  LUMO = 1.34133868147
    CPU time for vj and vk                                               1.45 sec, wall time      1.05 sec, GPU time   1045.20 ms
E1 = (-201.4050084977777-3.7238730617635457e-16j)  E_coul = (81.12777228580339-3.5388358909926865e-16j)
    CPU time for cycle=5                                                 1.52 sec, wall time      1.06 sec, GPU time   1063.28 ms
cycle= 5 E= -359.603993911823  delta_E= -1.65  |g|= 1.25  |ddm|= 2.52
alpha HOMO = 0.881720887405  LUMO = 1.4172166007
beta HOMO = 0.881720887405  LUMO = 1.4172166007
    CPU time for vj and vk                                               1.45 sec, wall time      1.04 sec, GPU time   1044.40 ms
E1 = (-206.56237175477906-3.929148673087468e-16j)  E_coul = (85.85648164431838+3.700743415417188e-17j)
    CPU time for cycle=6                                                 1.52 sec, wall time      1.06 sec, GPU time   1062.60 ms
cycle= 6 E= -360.03264781031  delta_E= -0.429  |g|= 0.55  |ddm|= 1.91
alpha HOMO = 0.88855376519  LUMO = 1.44816305088
beta HOMO = 0.88855376519  LUMO = 1.44816305088
    CPU time for vj and vk                                               1.45 sec, wall time      1.05 sec, GPU time   1046.05 ms
E1 = (-207.00327102414272-3.856868528255101e-16j)  E_coul = (86.20536822575912-5.724587470723463e-16j)
    CPU time for cycle=7                                                 1.52 sec, wall time      1.06 sec, GPU time   1064.46 ms
cycle= 7 E= -360.124660498233  delta_E= -0.092  |g|= 0.344  |ddm|= 0.745
alpha HOMO = 0.926931999861  LUMO = 1.45356640536
beta HOMO = 0.926931999861  LUMO = 1.45356640536
    CPU time for vj and vk                                               1.45 sec, wall time      1.04 sec, GPU time   1044.95 ms
E1 = (-207.09391346451525-4.010102435299719e-16j)  E_coul = (86.24532396596825+6.638208501404581e-16j)
    CPU time for cycle=8                                                 1.53 sec, wall time      1.06 sec, GPU time   1063.54 ms
cycle= 8 E= -360.175347198396  delta_E= -0.0507  |g|= 0.138  |ddm|= 0.828
alpha HOMO = 0.926647126764  LUMO = 1.45895014951
beta HOMO = 0.926647126764  LUMO = 1.45895014951
    CPU time for vj and vk                                               1.45 sec, wall time      1.05 sec, GPU time   1045.04 ms
E1 = (-207.08018427077312-3.997092009229893e-16j)  E_coul = (86.22434643814495-2.9952892018532868e-16j)
    CPU time for cycle=9                                                 1.52 sec, wall time      1.06 sec, GPU time   1063.74 ms
cycle= 9 E= -360.182595532477  delta_E= -0.00725  |g|= 0.095  |ddm|= 0.205
alpha HOMO = 0.93171489872  LUMO = 1.45887419051
beta HOMO = 0.93171489872  LUMO = 1.45887419051
    CPU time for vj and vk                                               1.45 sec, wall time      1.05 sec, GPU time   1046.04 ms
E1 = (-207.12432616193013-4.010102435299719e-16j)  E_coul = (86.26335777491349-1.0674331788843952e-15j)
    CPU time for cycle=10                                                1.53 sec, wall time      1.06 sec, GPU time   1064.85 ms
cycle= 10 E= -360.187726086866  delta_E= -0.00513  |g|= 0.0712  |ddm|= 0.231

WARN: SCF failed to converge

    CPU time for SCF                                                    23.79 sec, wall time     12.36 sec, GPU time  12251.64 ms
SCF not converged.
SCF energy = -360.187726086866
ene_ref =  -360.941504
ene_sol =  -360.187726
error   = 7.54e-01
End time = Sun Nov 16 08:37:19 PM PST 2025
